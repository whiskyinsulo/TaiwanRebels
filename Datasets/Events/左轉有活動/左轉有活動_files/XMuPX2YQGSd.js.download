if (self.CavalryLogger) { CavalryLogger.start_js(["2z2N9"]); }

__d("MContextualThing",["FlowMigrationUtilsForLegacyFiles"],(function(a,b,c,d,e,f){f.register=a;f.containsIncludingLayers=c;f.getContext=h;var g=0;function a(a,b){b.id=b.id||"ctxtlayer_"+g++,a.setAttribute("data-ownerid",b.id)}function c(a,b){b=b;while(b){if(a.contains(b))return!0;b=h(b)}return!1}function h(a){a=a;while(a){if(a instanceof Element){var c=a.getAttribute("data-ownerid");if(!b("FlowMigrationUtilsForLegacyFiles").isFalsy(c))return document.getElementById(c)}a=a.parentNode}return null}}),null);
__d("BehaviorsMixin",[],(function(a,b,c,d,e,f){var g=function(){function a(a){this.$1=a,this.$2=!1}var b=a.prototype;b.enable=function(){this.$2||(this.$2=!0,this.$1.enable())};b.disable=function(){this.$2&&(this.$2=!1,this.$1.disable())};return a}(),h=1;function i(a){a.__BEHAVIOR_ID||(a.__BEHAVIOR_ID=h++);return a.__BEHAVIOR_ID}a={enableBehavior:function(a){this._behaviors||(this._behaviors={});var b=i(a);this._behaviors[b]||(this._behaviors[b]=new g(new a(this)));this._behaviors[b].enable();return this},disableBehavior:function(a){if(this._behaviors){a=i(a);this._behaviors[a]&&this._behaviors[a].disable()}return this},enableBehaviors:function(a){a.forEach(this.enableBehavior,this);return this},destroyBehaviors:function(){if(this._behaviors){for(var a in this._behaviors)this._behaviors[a].disable();this._behaviors={}}},hasBehavior:function(a){return this._behaviors&&i(a)in this._behaviors}};b=a;e.exports=b}),null);
__d("MLayer",["BehaviorsMixin","CSS","DOM","FlowMigrationUtilsForLegacyFiles","MContextualThing","MLegacyDataStore","Stratcom","ge","mixInEventEmitter","mixin","nullthrows","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){var g=[],h={};d=function(a){babelHelpers.inheritsLoose(c,a);function c(b){var c;c=a.call(this)||this;c.$MLayer2=!1;c.$MLayer3=!1;c.$MLayer4=!1;c.$MLayer5=null;c.config=b||{layerid:void 0};return c}var d=c.prototype;d.init=function(a){if(this.config.layerid){if(h[this.config.layerid])return;h[this.config.layerid]=this}this.configure(this.config,b("nullthrows")(a));a=this.config.addedBehaviors||[];this.enableBehaviors(this.getDefaultBehaviors().concat(a));a=b("ge")("flyout-nocontext-root");a||(a=b("DOM").create("div",{id:"flyout-nocontext-root"}));b("DOM").appendContent(document.body,a);b("DOM").appendContent(a,this.getRoot());b("DOM").hide(this.getRoot());b("Stratcom").invoke("m:layer:init",null,this)};d.configure=function(a,c){this.$MLayer1=this.buildWrapper(a,c);b("Stratcom").addSigil(this.$MLayer1,"m-layer-root");c=a.attributes;if(c){if(c.sigil){var d=c.sigil.split(" ");d.forEach(function(a){b("Stratcom").addSigil(this.$MLayer1,a)},this);delete c.sigil}for(var e in c)this.getRoot().setAttribute(e,c[e])}a.classNames&&a.classNames.forEach(function(a){b("CSS").conditionClass(this.$MLayer1,a,!0)},this);a.causalElement&&(this.$MLayer5=a.causalElement);b("MLegacyDataStore").set(this.getRoot(),{layer:this})};d.getDefaultBehaviors=function(){return[]};d.getCausalElement=function(){return this.$MLayer5};d.setCausalElement=function(a){this.$MLayer5=a;return this};d.setPreventShowOnce=function(){this.$MLayer4=!0};d.getInsertParent=function(){return this.insertParent||b("nullthrows")(document.body)};d.getRoot=function(){return b("nullthrows")(this.$MLayer1)};d.getContentRoot=function(){return this.$MLayer1};d.buildWrapper=function(a,b){return b};d.setInsertParent=function(a){a&&(this.$MLayer2&&a!==this.getInsertParent()&&(b("DOM").appendContent(a,this.getRoot()),this.updatePosition()),this.insertParent=a);return this};d.show=function(){if(this.$MLayer2)return this;var a=this.getRoot(),c=this.getInsertParent();a.parentNode!==c&&b("DOM").appendContent(c,a);this.emit("beforeshow");if(this.$MLayer4){this.$MLayer4=!1;return this}a.style.visibility="hidden";a.style.overflow="hidden";b("DOM").show(a);this.updatePosition()!==!1?(this.$MLayer2=!0,this.emit("show"),b("Stratcom").invoke("Layer:show",null,this),b("setTimeoutAcrossTransitions")(function(){this.$MLayer2&&g.push(this)}.bind(this))):b("DOM").hide(a);a.style.visibility="";a.style.overflow="";this.emit("aftershow");return this};d.hide=function(){if(this.$MLayer3||!this.$MLayer2||this.emit("beforehide")===!1)return this;this.$MLayer3=!0;this.emit("starthide")!==!1&&this.config.fadeonhide!==!0&&this.finishHide();return this};d.conditionShow=function(a){return a?this.show():this.hide()};d.finishHide=function(){this.$MLayer2&&(g.splice(g.indexOf(this),1),this.$MLayer3=!1,this.$MLayer2=!1,b("DOM").hide(this.getRoot()),this.emit("hide"),b("Stratcom").invoke("m:layer:hide",null,this));return this};d.isShown=function(){return this.$MLayer2};d.updatePosition=function(){return!0};d.updateIfShown=function(){this.isShown()&&this.updatePosition()};d.isDestroyed=function(){return this.destroyed};d.destroy=function(){if(this.destroyed)return;this.destroyed=!0;this.finishHide();var a=this.getRoot();b("DOM").remove(a);this.destroyBehaviors();this.emit("destroy");b("Stratcom").invoke("Layer:destroy",null,this);delete b("MLegacyDataStore").get(a).layer;this.$MLayer1=this.$MLayer5=null;this.config.layerid&&delete h[this.config.layerid];this.config=null};d.shouldBlurOnTouchEnd=function(){return!0};c.getLayers=function(){return h};c.show=function(a){a.show()};return c}(b("mixin")(b("BehaviorsMixin")));e.exports=d;b("mixInEventEmitter")(d,{destroy:!0,blur:!0,beforeshow:!0,show:!0,aftershow:!0,beforehide:!0,starthide:!0,hide:!0});var i;function a(a){a=a.getTouch();var b=a.clientX;a=a.clientY;i={x:b,y:a}}function c(a){var c=g.length;if(!c)return;var d=a.getTarget(),e=a.getType();if(!b("nullthrows")(document.documentElement).contains(d))return;if(e==="touchend"&&i){a=a.getTouch();var f=a.clientX;a=a.clientY;f=Math.sqrt(Math.pow(i.x-f,2)+Math.pow(i.y-a,2));i=null;if(f>5)return}while(c--){a=g[c];if(!a.isShown())continue;f=a.getContentRoot();if(f==null)throw b("FlowMigrationUtilsForLegacyFiles").invariantViolation("Called MLayer.onClickOrTouchEnd after the layer was already destroyed");if(b("MContextualThing").containsIncludingLayers(f,d))return;f=a.getCausalElement();if(e==="touchend"&&f&&(f.contains(d)||f===d||!a.shouldBlurOnTouchEnd()))continue;if(a.emit("blur")===!1||a.isShown())return}}b("Stratcom").listen("touchstart",null,a);b("Stratcom").listen("click",null,c);b("Stratcom").listen("touchend",null,c)}),null);